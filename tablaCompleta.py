# Tabla completa de intensidades máximas admisibles
tabla = {
    # A1
    ("A1", "3xPVC"): {1.5: 11.5, 2.5: 15.5, 4: 20, 6: 26, 10: 36, 16: 48, 25: 63},
    ("A1", "2xPVC"): {1.5: 12.5, 2.5: 17, 4: 22, 6: 29, 10: 40, 16: 53, 25: 69},
    ("A1", "3xXLPE"): {1.5: 15.5, 2.5: 20, 4: 28, 6: 36, 10: 49, 16: 66, 25: 86, 35: 106, 50: 128, 70: 162, 95: 196, 120: 226, 150: 259, 185: 294, 240: 345},
    ("A1", "2xXLPE"): {1.5: 16.5, 2.5: 22, 4: 30, 6: 39, 10: 54, 16: 72, 25: 91, 35: 114, 50: 139, 70: 178, 95: 216, 120: 251, 150: 289, 185: 329, 240: 385},

    # A2
    ("A2", "3xPVC"): {1.5: 11, 2.5: 15, 4: 20, 6: 25, 10: 33, 16: 45, 25: 59},
    ("A2", "2xPVC"): {1.5: 11.5, 2.5: 15.5, 4: 20, 6: 26, 10: 36, 16: 48, 25: 63},
    ("A2", "3xXLPE"): {1.5: 14, 2.5: 19, 4: 25, 6: 32, 10: 45, 16: 61, 25: 80, 35: 100, 50: 121, 70: 155, 95: 188, 120: 217},
    ("A2", "2xXLPE"): {1.5: 15.5, 2.5: 20, 4: 28, 6: 36, 10: 49, 16: 66, 25: 86, 35: 106, 50: 128, 70: 162, 95: 196, 120: 226, 150: 259, 185: 294, 240: 345},

    # B1
    ("B1", "3xPVC"): {1.5: 13.5, 2.5: 18, 4: 24, 6: 31, 10: 43, 16: 59, 25: 77, 35: 95, 50: 116, 70: 148, 95: 180, 120: 207},
    ("B1", "2xPVC"): {1.5: 14.5, 2.5: 20, 4: 26, 6: 34, 10: 46, 16: 63, 25: 82, 35: 101, 50: 122, 70: 155, 95: 187, 120: 216, 150: 247, 185: 281, 240: 330},
    ("B1", "3xXLPE"): {1.5: 17.5, 2.5: 24, 4: 32, 6: 41, 10: 57, 16: 77, 25: 100, 35: 124, 50: 151, 70: 193, 95: 234, 120: 272, 150: 313, 185: 356, 240: 419},
    ("B1", "2xXLPE"): {1.5: 20, 2.5: 28, 4: 38, 6: 49, 10: 68, 16: 91, 25: 115, 35: 143, 50: 174, 70: 223, 95: 271, 120: 314, 150: 359, 185: 409, 240: 489},

    # B2
    ("B2", "3xPVC"): {1.5: 12.5, 2.5: 17, 4: 22, 6: 29, 10: 40, 16: 53, 25: 69},
    ("B2", "2xPVC"): {1.5: 13.5, 2.5: 18, 4: 24, 6: 31, 10: 43, 16: 59, 25: 77, 35: 95, 50: 116, 70: 148, 95: 180, 120: 207},
    ("B2", "3xXLPE"): {1.5: 16.5, 2.5: 22, 4: 30, 6: 39, 10: 54, 16: 72, 25: 91, 35: 114, 50: 139, 70: 178, 95: 216, 120: 251, 150: 289, 185: 329, 240: 385},
    ("B2", "2xXLPE"): {1.5: 17.5, 2.5: 24, 4: 32, 6: 41, 10: 57, 16: 77, 25: 100, 35: 124, 50: 151, 70: 193, 95: 234, 120: 272, 150: 313, 185: 356, 240: 419},

    # C
    ("C", "3xPVC"): {1.5: 14.5, 2.5: 20, 4: 26, 6: 34, 10: 46, 16: 63, 25: 82, 35: 101, 50: 122, 70: 155, 95: 187, 120: 216, 150: 247, 185: 281, 240: 330},
    ("C", "2xPVC"): {1.5: 17, 2.5: 23, 4: 31, 6: 40, 10: 54, 16: 73, 25: 95, 35: 119, 50: 145, 70: 185, 95: 224, 120: 260, 150: 299, 185: 341, 240: 401},
    ("C", "3xXLPE"): {1.5: 20, 2.5: 27, 4: 36, 6: 46, 10: 63, 16: 85, 25: 108, 35: 133, 50: 162, 70: 208, 95: 252, 120: 293, 150: 337, 185: 385, 240: 455},
    ("C", "2xXLPE"): {1.5: 21, 2.5: 30, 4: 40, 6: 52, 10: 72, 16: 97, 25: 122, 35: 153, 50: 188, 70: 243, 95: 298, 120: 350, 150: 401, 185: 460, 240: 545},

    # E
    ("E", "3xXLPE"): {1.5: 21, 2.5: 29, 4: 38, 6: 49, 10: 67, 16: 91, 25: 118, 35: 142, 50: 168, 70: 209, 95: 250, 120: 287, 150: 328, 185: 376, 240: 444},
    ("E", "2xXLPE"): {1.5: 21, 2.5: 30, 4: 39, 6: 50, 10: 69, 16: 94, 25: 122, 35: 147, 50: 175, 70: 218, 95: 261, 120: 299, 150: 341, 185: 392, 240: 463},

    # F
    ("F", "3xXLPE"): {1.5: 21, 2.5: 30, 4: 40, 6: 51, 10: 70, 16: 94, 25: 121, 35: 145, 50: 173, 70: 216, 95: 260, 120: 297, 150: 338, 185: 387, 240: 457},
    ("F", "2xXLPE"): {1.5: 23, 2.5: 31, 4: 41, 6: 52, 10: 72, 16: 97, 25: 125, 35: 150, 50: 179, 70: 222, 95: 267, 120: 305, 150: 349, 185: 400, 240: 472},
}

def calcular_seccion(metodo, tipo_cable, intensidad_requerida):
    clave = (metodo, tipo_cable)
    if clave not in tabla:
        return f"❌ No hay datos para el método '{metodo}' y tipo de cable '{tipo_cable}'"
    
    opciones = tabla[clave]
    for seccion, intensidad in sorted(opciones.items()):
        if intensidad >= intensidad_requerida:
            return f"✅ Sección mínima necesaria: {seccion} mm² (Soporta {intensidad} A)"
    
    return "❌ Ninguna sección disponible soporta esa intensidad"

def menu():
    print("📐 Cálculo de sección mínima de conductor (tabla ampliada)")
    metodo = input("Método de instalación (ej. B1, C, D...): ").strip()
    tipo = input("Tipo de cable (ej. 2xPVC, 3xXLPE): ").replace(" ", "")
    try:
        intensidad = float(input("Intensidad requerida (A): "))
    except ValueError:
        print("⚠️ La intensidad debe ser un número.")
        return
    resultado = calcular_seccion(metodo, tipo, intensidad)
    print("\n" + resultado)

if __name__ == "__main__":
    menu()
